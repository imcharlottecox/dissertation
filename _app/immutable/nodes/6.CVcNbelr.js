import"../chunks/DsnmJJEf.js";import{i as O}from"../chunks/BTGwZlOP.js";import{o as Q,s as V}from"../chunks/DUppubXp.js";import{a5 as $,av as tt,a2 as at,X,Z as R,a3 as et,_ as W,$ as z,t as u,z as rt,a0 as k,a4 as ot,Y as st}from"../chunks/BoqFzqd8.js";import{e as lt}from"../chunks/Bp7G4JeZ.js";import{b as nt}from"../chunks/DJtt0LSM.js";import{i as Ct}from"../chunks/B2nU15ES.js";import{s as it,z as mt}from"../chunks/CsbEx7zF.js";import{d as ft}from"../chunks/B-ELdldP.js";import{s as ct}from"../chunks/DBryx5vg.js";import{l as dt,m as gt,a as bt}from"../chunks/BReedbPm.js";import{x as ht,y as pt}from"../chunks/Dca5MbJk.js";function P(x,i,v){var d=$(x,i);d&&d.set&&(x[i]=v,tt(()=>{x[i]=null}))}var ut=X('<span class="word svelte-7ct5gl"> </span>'),xt=X('<main><div class="box svelte-7ct5gl"><h3 class="svelte-7ct5gl">Corpus</h3> <div style="display: flex; flex-wrap: wrap; gap: 4px;"></div></div> <svg class="svelte-7ct5gl"></svg></main>');function _t(x,i){at(i,!1);const v=["START"],d=["Cat","Car","Caress","Cattle","Cambridge","Carton","Cart","Carts","Cats","Cars","Caresses","Cartons","Cartwheel","Caramel","ACCEPT"],y=["START","C","Ca","Cat","Cats","Catt","Cattl","Cattle","Car","Cars","Cara","Caram","Carame","Caramel","Care","Cares","Caress","Caresse","Caresses","Cart","Carts","Carto","Carton","Cartons","Cartw","Cartwh","Cartwhe","Cartwhee","Cartwheel","Cam","Camb","Cambr","Cambri","Cambrid","Cambridg","Cambridge"],w=[{from:"START",to:"C",label:"C"},{from:"C",to:"Ca",label:"a"},{from:"Ca",to:"Cat",label:"t"},{from:"Cat",to:"ACCEPT",label:"END"},{from:"Cat",to:"Cats",label:"s"},{from:"Cats",to:"ACCEPT",label:"END"},{from:"Cat",to:"Catt",label:"t"},{from:"Catt",to:"Cattl",label:"l"},{from:"Cattl",to:"Cattle",label:"e"},{from:"Cattle",to:"ACCEPT",label:"END"},{from:"Ca",to:"Car",label:"r"},{from:"Car",to:"ACCEPT",label:"END"},{from:"Car",to:"Cars",label:"s"},{from:"Cars",to:"ACCEPT",label:"END"},{from:"Car",to:"Cara",label:"a"},{from:"Cara",to:"Caram",label:"m"},{from:"Caram",to:"Carame",label:"e"},{from:"Carame",to:"Caramel",label:"l"},{from:"Caramel",to:"ACCEPT",label:"END"},{from:"Car",to:"Care",label:"e"},{from:"Care",to:"Cares",label:"s"},{from:"Cares",to:"Caress",label:"s"},{from:"Caress",to:"ACCEPT",label:"END"},{from:"Caress",to:"Caresse",label:"e"},{from:"Caresse",to:"Caresses",label:"s"},{from:"Caresses",to:"ACCEPT",label:"END"},{from:"Car",to:"Cart",label:"t"},{from:"Cart",to:"ACCEPT",label:"END"},{from:"Cart",to:"Carts",label:"s"},{from:"Carts",to:"ACCEPT",label:"END"},{from:"Cart",to:"Carto",label:"o"},{from:"Carto",to:"Carton",label:"n"},{from:"Carton",to:"ACCEPT",label:"END"},{from:"Carton",to:"Cartons",label:"s"},{from:"Cartons",to:"ACCEPT",label:"END"},{from:"Cart",to:"Cartw",label:"w"},{from:"Cartw",to:"Cartwh",label:"h"},{from:"Cartwh",to:"Cartwhe",label:"e"},{from:"Cartwhe",to:"Cartwhee",label:"e"},{from:"Cartwhee",to:"Cartwheel",label:"l"},{from:"Cartwheel",to:"ACCEPT",label:"END"},{from:"Ca",to:"Cam",label:"m"},{from:"Cam",to:"Camb",label:"b"},{from:"Camb",to:"Cambr",label:"r"},{from:"Cambr",to:"Cambri",label:"i"},{from:"Cambri",to:"Cambrid",label:"d"},{from:"Cambrid",to:"Cambridg",label:"g"},{from:"Cambridg",to:"Cambridge",label:"e"},{from:"Cambridge",to:"ACCEPT",label:"END"}],b=600,E=20,m=20,Y=10,j=10;let g=100,h=rt(),f=[],B=w;function H(){const r=g-2*m,s=y.length;f=y.map((a,l)=>{const o=m+l/(s-1)*r;let C;["START","C","Ca","Car","Cart"].includes(a)||a.startsWith("Carto")?C=b*.5:["Cat","Cats"].includes(a)?C=b*.7:["Cars","Carts"].includes(a)?C=b*.3:C=b*.5;const n=f.find(A=>A.id===a),T=n&&(n.fx!==o||n.fy!==C);return{id:a,x:T?n.fx:o,y:T?n.fy:C}})}function q(r){const s=new Map;r.forEach(o=>{s.has(o.from)||s.set(o.from,[]),s.get(o.from).push(o.to)});const a=new Map,l=["START"];for(a.set("START",0);l.length>0;){const o=l.shift(),C=s.get(o)||[];for(const n of C)a.has(n)||(a.set(n,a.get(o)+1),l.push(n))}return a}function G(){if(!u(h))return;const r=it(u(h));r.selectAll(".content-group").remove();const s=new Map(f.map(t=>[t.id,t])),a=B.map(t=>({label:t.label,source:s.get(t.from),target:s.get(t.to)})).filter(t=>!!(t.source&&t.target));console.log("nodeMap, resolvedEdges:",s,a);const l=r.append("g").attr("class","content-group"),o=mt().on("zoom",t=>{l.attr("transform",t.transform)});r.call(o),r.call(o.transform,Ct);const C=ft().on("start",(t,e)=>{t.active||A.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}).on("drag",(t,e)=>{e.fx=e.x=t.x,e.fy=e.y=t.y,S()}).on("end",(t,e)=>{const c=f.findIndex(p=>p.id===e.id);t.active||A.alphaTarget(0),c!==-1&&(f[c].fx=e.x,f[c].fy=e.y)}),n=q(w),T=Math.max(...n.values()),A=ct(f).force("link",dt(a).id(t=>t.id).distance(75)).force("charge",gt().strength(-1e3)).force("center",bt(g/2+2*m,300)).force("xLevel",ht(t=>{const e=n.get(t.id)??0;return v.includes(t.id)?g*.025:m+e/T*(g-2*m)}).strength(1)).force("ySpread",pt(b/2)).alphaDecay(.09).on("tick",S);r.append("svg:defs").append("svg:marker").attr("id","arrowhead").attr("viewBox",[0,0,Y,j]).attr("refX",42).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");const F=l.append("g").attr("stroke","black").selectAll("line").data(a).join("line").attr("marker-end","url(#arrowhead)").attr("stroke","grey"),J=l.append("g").selectAll("text").data(a).join("text").attr("font-size",10).text(t=>t.label),M=l.append("g").selectAll("g").data(f,t=>t.id).join("g").call(C);M.append("circle").attr("r",E).attr("fill",t=>d.includes(t.id)?"lightgreen":"lightblue").attr("stroke","black").attr("stroke-width",t=>d.includes(t.id)?3:.5),M.append("text").attr("text-anchor","middle").attr("dy",5).attr("font-size",10).text(t=>t.id);function S(){f.forEach(t=>{const e=E+m,c=g-E-m,p=E+m,_=b-E-m;t.x=Math.max(e,Math.min(c,t.x)),t.y=Math.max(p,Math.min(_,t.y))}),F.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y).attr("d",function(t){const e=t.target.x-t.source.x,c=t.target.y-t.source.y,p=Math.sqrt(e*e+c*c),_=e*t.target.radius/p,K=c*t.target.radius/p;return"M"+t.source.x+","+t.source.y+"L"+(t.target.x-_)+","+(t.target.y-K)}).attr("stroke",t=>t.target.x>=t.source.x?"grey":"blue"),J.attr("x",t=>(t.source.x+t.target.x)/2.01).attr("y",t=>(t.source.y+t.target.y)/2.02),M.attr("transform",t=>`translate(${t.x},${t.y})`)}S()}Q(()=>{g=u(h).clientWidth,H(),G();const r=()=>{g=u(h).clientWidth};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)});const I=d.filter(r=>r!=="ACCEPT");var U={startingStates:v,acceptingStates:d,fsmStates:y,fsmTransitions:w};O();var D=xt(),N=z(D),L=W(z(N),2);lt(L,5,()=>I,r=>r,(r,s)=>{var a=ut(),l=z(a,!0);k(a),st(()=>V(l,u(s))),R(r,a)}),k(L),k(N);var Z=W(N,2);return nt(Z,r=>ot(h,r),()=>u(h)),k(D),R(x,D),P(i,"startingStates",v),P(i,"acceptingStates",d),P(i,"fsmStates",y),P(i,"fsmTransitions",w),et(U)}export{_t as component};
