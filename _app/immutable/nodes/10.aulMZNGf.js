import"../chunks/DsnmJJEf.js";import{i as _}from"../chunks/BTGwZlOP.js";import{o as B}from"../chunks/DUppubXp.js";import{a2 as H,X as Y,Z as j,a3 as q,_ as G,$ as I,t as x,z as N,a4 as O,a0 as P}from"../chunks/BoqFzqd8.js";import{b as U}from"../chunks/DJtt0LSM.js";import{i as V}from"../chunks/B2nU15ES.js";import{s as Z,z as D}from"../chunks/CsbEx7zF.js";import{d as F}from"../chunks/B-ELdldP.js";import{s as J}from"../chunks/DBryx5vg.js";import{l as K,m as Q,a as tt}from"../chunks/BReedbPm.js";import{c as at}from"../chunks/DKhEXa-U.js";function rt(){return{markovStates:["START","C","Ca","Cat","Cats","Car","Cars","Cart","Carts","Carto","Carton","Cartons","$"],markovTransitions:[{from:"START",to:"C",probability:1},{from:"C",to:"Ca",probability:1},{from:"Ca",to:"Cat",probability:.5},{from:"Ca",to:"Car",probability:.5},{from:"Cat",to:"Cats",probability:.5},{from:"Cat",to:"$",probability:.5},{from:"Cats",to:"$",probability:1},{from:"Car",to:"Cart",probability:.33},{from:"Car",to:"Cars",probability:.33},{from:"Car",to:"$",probability:.33},{from:"Cars",to:"$",probability:1},{from:"Cart",to:"Carts",probability:.33},{from:"Cart",to:"Carto",probability:.33},{from:"Cart",to:"$",probability:.33},{from:"Carts",to:"$",probability:1},{from:"Carto",to:"Carton",probability:1},{from:"Carton",to:"Cartons",probability:.5},{from:"Carton",to:"$",probability:.5},{from:"Cartons",to:"$",probability:1},{from:"$",to:"$",probability:1}],mStartingStates:["START"],endState:["$"]}}var ot=Y('<main class="svelte-1r1c9z4"><h1>Markov Model Visualization</h1> <svg class="svelte-1r1c9z4"></svg></main>');function bt(T,z){H(z,!1);const{markovStates:v,markovTransitions:k}=rt(),M=600,b=20,m=20,w=10,L=10;let h=100,g=N(),f=[],A=k;function E(){const o=h-2*m,y=M-2*m,l=new Map;k.forEach(r=>{l.has(r.from)||l.set(r.from,[]),l.get(r.from).push(r.to)});const e=new Map,d=["START"];for(e.set("START",0);d.length>0;){const r=d.shift(),i=l.get(r)||[];for(const c of i)e.has(c)||(e.set(c,(e.get(r)??0)+1),d.push(c))}const u=Math.max(...e.values()),p=new Map;v.forEach(r=>{const i=e.get(r)??u;p.has(i)||p.set(i,[]),p.get(i).push(r)}),f=v.map(r=>{const i=e.get(r)??u,c=p.get(i)||[],C=c.indexOf(r),t=m+i/u*y,a=o/(c.length+10),n=m+(C+1)*a;let s=0;return r.endsWith("s")?s=60:r.includes("Carto")?s=-80:r.includes("Cat")?s=-40:r.includes("Car")&&(s=40),{id:r,x:n+s,y:t}})}function W(){if(!x(g))return;const o=Z(x(g));o.selectAll(".content-group").remove();const y=new Map(f.map(t=>[t.id,t])),l=A.map(t=>({label:t.probability,source:y.get(t.from),target:y.get(t.to)})).filter(t=>!!(t.source&&t.target));console.log("nodeMap, resolvedEdges:",y,l);const e=o.append("g").attr("class","content-group"),d=D().on("zoom",t=>{e.attr("transform",t.transform)});o.call(d),o.call(d.transform,V);const u=F().on("start",(t,a)=>{t.active||p.alphaTarget(.3).restart(),a.fx=a.x,a.fy=a.y}).on("drag",(t,a)=>{a.fx=a.x=t.x,a.fy=a.y=t.y,C()}).on("end",(t,a)=>{const n=f.findIndex(s=>s.id===a.id);t.active||p.alphaTarget(0),n!==-1&&(f[n].fx=a.x,f[n].fy=a.y)}),p=J(f).force("link",K(l).id(t=>t.id).distance(100)).force("charge",Q().strength(-50)).force("center",tt(h/2,M/2)).force("collide",at().radius(30)).on("tick",C);o.append("svg:defs").append("svg:marker").attr("id","arrowhead").attr("viewBox",[0,0,w,L]).attr("refX",42).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");const r=e.append("g").attr("stroke","black").selectAll("line").data(l).join("line").attr("marker-end","url(#arrowhead)").attr("stroke","grey"),i=e.append("g").selectAll("text").data(l).join("text").attr("font-size",10).text(t=>t.label),c=e.append("g").selectAll("g").data(f,t=>t.id).join("g").call(u);c.append("circle").attr("r",b).attr("stroke","black").attr("fill","lightblue"),c.append("text").attr("text-anchor","middle").attr("dy",5).attr("font-size",10).text(t=>t.id);function C(){f.forEach(t=>{const a=b+m,n=h-b-m,s=b+m,S=M-b-m;t.x=Math.max(a,Math.min(n,t.x)),t.y=Math.max(s,Math.min(S,t.y))}),r.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y).attr("d",function(t){const a=t.target.x-t.source.x,n=t.target.y-t.source.y,s=Math.sqrt(a*a+n*n),S=a*t.target.radius/s,X=n*t.target.radius/s;return"M"+t.source.x+","+t.source.y+"L"+(t.target.x-S)+","+(t.target.y-X)}).attr("stroke",t=>t.target.y>=t.source.y?"grey":"blue"),i.attr("x",t=>(t.source.x+t.target.x)/2.01).attr("y",t=>(t.source.y+t.target.y)/2.02),c.attr("transform",t=>`translate(${t.x},${t.y})`)}C()}B(()=>{h=x(g).clientWidth,E(),W();const o=()=>{h=x(g).clientWidth};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),_();var $=ot(),R=G(I($),2);U(R,o=>O(g,o),()=>x(g)),P($),j(T,$),q()}export{bt as component};
