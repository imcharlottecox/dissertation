import"../chunks/DsnmJJEf.js";import{i as P}from"../chunks/BTGwZlOP.js";import{o as D}from"../chunks/DUppubXp.js";import{a2 as q,X as N,Z as F,a3 as G,_ as I,$ as U,t as x,z as Z,a4 as J,a0 as K}from"../chunks/BoqFzqd8.js";import{b as O}from"../chunks/DJtt0LSM.js";import{i as Q}from"../chunks/B2nU15ES.js";import{s as V,z as tt}from"../chunks/CsbEx7zF.js";import{d as et}from"../chunks/B-ELdldP.js";import{s as rt}from"../chunks/DBryx5vg.js";import{l as at,m as ot,a as st}from"../chunks/BReedbPm.js";import{c as nt}from"../chunks/DKhEXa-U.js";import{x as lt,y as it}from"../chunks/Dca5MbJk.js";var ct=N('<main><h1>My Finite State Machine!</h1> <svg class="svelte-1h9s455"></svg></main>');function kt(E,S){q(S,!1);const v=["surrender","ACCEPT"],z=["START"],C=["START","we","shall","fight","on","the","beaches","landing","grounds","in","fields","and","streets","hills","never","surrender","ACCEPT"],A=[{from:"START",to:"we",label:"we"},{from:"we",to:"shall",label:"shall"},{from:"shall",to:"fight",label:"fight"},{from:"fight",to:"on",label:"on"},{from:"on",to:"the",label:"the"},{from:"the",to:"beaches",label:"beaches"},{from:"beaches",to:"we",label:"we"},{from:"the",to:"landing",label:"landing"},{from:"landing",to:"grounds",label:"grounds"},{from:"grounds",to:"we",label:"we"},{from:"fight",to:"in",label:"in"},{from:"in",to:"the",label:"the"},{from:"the",to:"fields",label:"fields"},{from:"fields",to:"and",label:"and"},{from:"and",to:"in",label:"in"},{from:"the",to:"streets",label:"streets"},{from:"streets",to:"we",label:"we"},{from:"the",to:"hills",label:"hills"},{from:"hills",to:"we",label:"we"},{from:"shall",to:"never",label:"never"},{from:"never",to:"surrender",label:"surrender"},{from:"surrender",to:"ACCEPT",label:"END"}],g=600,p=20,i=20,L=10,R=10;let d=100,h=Z(),c=[],W=A;function X(){const a=d-2*i,l=C.length;c=C.map((r,m)=>{const o=i+m/(l-1)*a;let s;["START","C","Ca","Car","Cart"].includes(r)||r.startsWith("Carto")?s=g*.5:["Cat","Cats"].includes(r)?s=g*.7:["Cars","Carts"].includes(r)?s=g*.3:s=g*.5;const n=c.find(y=>y.id===r),b=n&&(n.fx!==o||n.fy!==s);return{id:r,x:b?n.fx:o,y:b?n.fy:s}})}function Y(a){const l=new Map;a.forEach(o=>{l.has(o.from)||l.set(o.from,[]),l.get(o.from).push(o.to)});const r=new Map,m=["START"];for(r.set("START",0);m.length>0;){const o=m.shift(),s=l.get(o)||[];for(const n of s)r.has(n)||(r.set(n,r.get(o)+1),m.push(n))}return r}function _(){if(!x(h))return;const a=V(x(h));a.selectAll(".content-group").remove();const l=new Map(c.map(t=>[t.id,t])),r=W.map(t=>({label:t.label,source:l.get(t.from),target:l.get(t.to)})).filter(t=>!!(t.source&&t.target));console.log("nodeMap, resolvedEdges:",l,r);const m=Y(A),o=a.append("g").attr("class","content-group"),s=tt().on("zoom",t=>{o.attr("transform",t.transform)});a.call(s),a.call(s.transform,Q);const n=et().on("start",(t,e)=>{t.active||y.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}).on("drag",(t,e)=>{e.fx=e.x=t.x,e.fy=e.y=t.y,T()}).on("end",(t,e)=>{const f=c.findIndex(u=>u.id===e.id);t.active||y.alphaTarget(0),f!==-1&&(c[f].fx=e.x,c[f].fy=e.y)}),b=Math.max(...m.values()),y=rt(c).force("link",at(r).id(t=>t.id).distance(75)).force("charge",ot().strength(-1e3)).force("collide",nt().radius(22)).force("center",st(d/2+2*i,300)).force("xLevel",lt(t=>{const e=m.get(t.id)??0;return v.includes(t.id)?d*.975:z.includes(t.id)?d*.025:i+e/b*(d-2*i)}).strength(1)).force("ySpread",it(g/2)).alphaDecay(.05).on("tick",T);a.append("svg:defs").append("svg:marker").attr("id","arrowhead").attr("viewBox",[0,0,L,R]).attr("refX",42).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");const j=o.append("g").attr("stroke","black").selectAll("line").data(r).join("line").attr("stroke","grey").attr("marker-end","url(#arrowhead)"),B=o.append("g").selectAll("text").data(r).join("text").attr("font-size",10).text(t=>t.label),k=o.append("g").selectAll("g").data(c,t=>t.id).join("g").call(n);k.append("circle").attr("r",p).attr("fill",t=>v.includes(t.id)?"lightgreen":"lightblue").attr("stroke","black").attr("stroke-width",t=>v.includes(t.id)?3:.5),k.append("text").attr("text-anchor","middle").attr("dy",5).attr("font-size",10).text(t=>t.id),a.append("line").attr("x1",0).attr("y1",0).attr("x2",100).attr("y2",0).attr("stroke","red"),a.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",100).attr("stroke","blue");function T(){c.forEach(t=>{const e=p+i,f=d-p-i,u=p+i,M=g-p-i;t.x=Math.max(e,Math.min(f,t.x)),t.y=Math.max(u,Math.min(M,t.y))}),j.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y).attr("d",function(t){const e=t.target.x-t.source.x,f=t.target.y-t.source.y,u=Math.sqrt(e*e+f*f),M=e*t.target.radius/u,H=f*t.target.radius/u;return"M"+t.source.x+","+t.source.y+"L"+(t.target.x-M)+","+(t.target.y-H)}).attr("stroke",t=>t.target.x>=t.source.x?"black":"lightgrey"),B.attr("x",t=>(t.source.x+t.target.x)/2.01).attr("y",t=>(t.source.y+t.target.y)/2.02),k.attr("transform",t=>`translate(${t.x},${t.y})`)}T()}D(()=>{d=x(h).clientWidth,X(),_();const a=()=>{d=x(h).clientWidth};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)}),P();var w=ct(),$=I(U(w),2);O($,a=>J(h,a),()=>x(h)),K(w),F(E,w),G()}export{kt as component};
