import"../chunks/DsnmJJEf.js";import{i as _}from"../chunks/BTGwZlOP.js";import{o as R}from"../chunks/DUppubXp.js";import{a2 as X,X as H,Z as Y,a3 as $,_ as j,$ as B,t as m,z as q,a4 as F,a0 as G}from"../chunks/BoqFzqd8.js";import{b as I}from"../chunks/DJtt0LSM.js";import"../chunks/B2nU15ES.js";import{s as U,z as Z}from"../chunks/CsbEx7zF.js";import{d as J}from"../chunks/B-ELdldP.js";var K=H('<main><h1>My Finite State Machine!</h1> <svg class="svelte-1qfxalo"></svg></main>');function st(k,A){X(A,!1);const b=["Cat","Car","Cart","Carton","Cats","Cars","Carts","Cartons","ACCEPT"],y=["START","C","Ca","Cat","Cats","Car","Cars","Cart","Carts","Carto","Carton","Cartons"],T=[{from:"START",to:"C",label:"C"},{from:"C",to:"Ca",label:"a"},{from:"Ca",to:"Cat",label:"t"},{from:"Ca",to:"Car",label:"r"},{from:"Cat",to:"ACCEPT",label:"END"},{from:"Cat",to:"Cats",label:"s"},{from:"Cats",to:"ACCEPT",label:"END"},{from:"Car",to:"ACCEPT",label:"END"},{from:"Car",to:"Cart",label:"t"},{from:"Car",to:"Cars",label:"s"},{from:"Cars",to:"ACCEPT",label:"END"},{from:"Cart",to:"ACCEPT",label:"END"},{from:"Cart",to:"Carts",label:"s"},{from:"Carts",to:"ACCEPT",label:"END"},{from:"Cart",to:"Carto",label:"o"},{from:"Carto",to:"Carton",label:"n"},{from:"Carton",to:"ACCEPT",label:"END"},{from:"Carton",to:"Cartons",label:"s"},{from:"Cartons",to:"ACCEPT",label:"END"}],p=600,z=20,E=120,w=10,P=10;let x=100,i=q(),n=[],D=T;function M(){const r=x-2*E,C=y.length;n=y.map((e,c)=>{const d=E+c/(C-1)*r;let o;["START","C","Ca","Car","Cart"].includes(e)||e.startsWith("Carto")?o=p*.5:["Cat","Cats"].includes(e)?o=p*.7:["Cars","Carts"].includes(e)?o=p*.3:o=p*.5;const s=n.find(g=>g.id===e),f=s&&(s.fx!==d||s.fy!==o);return{id:e,x:f?s.fx:d,y:f?s.fy:o,fx:f?s.fx:d,fy:f?s.fy:o}})}function N(){if(!m(i))return;const r=U(m(i));r.selectAll(".content-group").remove();const C=new Map(n.map(t=>[t.id,t])),e=D.map(t=>({label:t.label,source:C.get(t.from),target:C.get(t.to)})).filter(t=>t.source&&t.target);console.log("nodeMap, resolvedEdges:",C,e);const c=r.append("g").attr("class","content-group"),d=Z().on("zoom",t=>{c.attr("transform",t.transform)});r.call(d);const o=J().on("start",(t,a)=>{a.fx=a.x,a.fy=a.y}).on("drag",(t,a)=>{a.fx=a.x=t.x,a.fy=a.y=t.y,v()}).on("end",(t,a)=>{const l=n.findIndex(u=>u.id===a.id);l!==-1&&(n[l].fx=a.x,n[l].fy=a.y)});r.append("svg:defs").append("svg:marker").attr("id","arrowhead").attr("viewBox",[0,0,w,P]).attr("refX",42).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z");const s=c.append("g").attr("stroke","black").selectAll("line").data(e).join("line").attr("marker-end","url(#arrowhead)").attr("stroke","grey"),f=c.append("g").selectAll("text").data(e).join("text").attr("font-size",10).text(t=>t.label),g=c.append("g").selectAll("g").data(n,t=>t.id).join("g").call(o);g.append("circle").attr("r",z).attr("fill",t=>b.includes(t.id)?"lightgreen":"lightblue").attr("stroke","black").attr("stroke-width",t=>b.includes(t.id)?3:.5),g.append("text").attr("text-anchor","middle").attr("dy",5).attr("font-size",10).text(t=>t.id);function v(){s.attr("x1",t=>t.source.x).attr("y1",t=>t.source.y).attr("x2",t=>t.target.x).attr("y2",t=>t.target.y).attr("d",function(t){const a=t.target.x-t.source.x,l=t.target.y-t.source.y,u=Math.sqrt(a*a+l*l),W=a*t.target.radius/u,S=l*t.target.radius/u;return"M"+t.source.x+","+t.source.y+"L"+(t.target.x-W)+","+(t.target.y-S)}).attr("stroke",t=>t.target.x>=t.source.x?"grey":"blue"),f.attr("x",t=>(t.source.x+t.target.x)/2.01).attr("y",t=>(t.source.y+t.target.y)/2.02),g.attr("transform",t=>`translate(${t.x},${t.y})`)}v()}R(()=>{x=m(i).clientWidth,M(),N();const r=()=>{x=m(i).clientWidth};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)}),_();var h=K(),L=j(B(h),2);I(L,r=>F(i,r),()=>m(i)),G(h),Y(k,h),$()}export{st as component};
